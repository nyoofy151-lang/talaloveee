<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªØ§Ù„Ø§ â¤ï¸</title>
<style>
    body {
        margin:0; padding:0;
        background:#ffe6f2;
        font-family:"Cairo", sans-serif;
        overflow-x:hidden;
    }
    h1 {
        text-align:center; margin-top:20px; font-size:45px;
        color:#d6006e; text-shadow:0 0 15px #ff4fa7;
    }
    #loveText {
        width:85%; max-width:700px; margin:20px auto;
        background:white; border-radius:15px; padding:20px;
        font-size:22px; line-height:1.8; color:#7a0058;
        box-shadow:0 0 20px rgba(255,0,128,0.25);
        min-height:200px; white-space:pre-line;
    }
    #chatBox {
        width:85%; max-width:600px; height:300px;
        background:white; margin:20px auto; border-radius:15px;
        padding:15px; overflow-y:auto; box-shadow:0 0 15px rgba(255,0,128,0.3);
    }
    .message {
        display:flex; justify-content:space-between; align-items:center;
        background:#ffe0f1; padding:10px; border-radius:10px; margin:5px 0;
        flex-wrap:wrap;
    }
    .msg-text { flex:1; margin-right:10px; word-break:break-word; }
    .msg-time { font-size:12px; color:#7a0058; margin-left:auto; }
    .msg-user { font-weight:bold; margin-left:5px; color:#d6006e; }
    .deleteBtn, .editBtn, .saveBtn { background:transparent; border:none; cursor:pointer; font-size:18px; margin-left:5px; }
    .deleteBtn { color:#d6006e; }
    .editBtn { color:#1a73e8; }
    .saveBtn { color:#00a600; }
    #messageInput { width:60%; padding:10px; border:2px solid #ff4fa7; border-radius:10px; font-size:18px; }
    #sendBtn { padding:10px 20px; background:#ff4fa7; border:none; border-radius:10px; color:white; font-size:18px; cursor:pointer; margin-left:10px; }
    .heart { position:fixed; bottom:-10px; color:#ff1f8f; font-size:20px; animation:floatUp 4s linear infinite; opacity:0.8; z-index:9999; }
    @keyframes floatUp { 0%{transform:translateY(0) scale(1); opacity:1;} 100%{transform:translateY(-120vh) scale(1.5); opacity:0;} }
    #loginOverlay {
        position:fixed; top:0; left:0; width:100%; height:100%;
        background:rgba(255,230,242,0.95); display:flex; flex-direction:column;
        justify-content:center; align-items:center; z-index:10000;
    }
    #loginOverlay input { padding:10px; font-size:18px; border-radius:10px; border:2px solid #ff4fa7; margin-bottom:10px; }
    #loginOverlay button { padding:10px 20px; background:#ff4fa7; border:none; border-radius:10px; color:white; font-size:18px; cursor:pointer; }
</style>
</head>
<body>

<h1>ğŸ’– ØªÙ€Ù€Ø§Ù„Ù€Ù€Ø§ ğŸ’–</h1>
<div id="loveText"></div>
<div id="chatBox"></div>
<div style="text-align:center; margin-bottom:30px;">
    <input id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
    <button id="sendBtn">Ø¥Ø±Ø³Ø§Ù„ â¤ï¸</button>
</div>

<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginOverlay">
    <input type="text" id="usernameInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
    <button id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
</div>

<script>
    // Ù†Øµ Ø§Ù„Ø­Ø¨
    const text = ` (Ø§Ø³Ù Ù…Ø§Ø¬Ø¯Ø¯ØªÙˆ Ù…Ù† Ù‚Ø¨Ù„ ÙƒÙ†Øª Ø§Ø¨ÙƒÙŠ Ù…Ù† Ù‚Ù„Ø¨ÙŠ )
    Ø§Ù„Ø´ÙˆÙ‚ Ø°Ø§Ø¨Ø­Ù†ÙŠ ÙˆØ§Ù†Ø§ Ø¹Ù„ÙŠÙƒ ÙˆÙ„Ù‡Ø§Ù†
ÙˆØ®Ø§Ø·Ø±ÙŠ Ù…Ù„ÙŠØ§Ù† ÙƒÙ„Ù‡ ØºØ±Ø§Ø¨ÙŠÙ„ ÙˆØ¹ØªØ§Ø¨
Ø£Ù†Ø§ Ø¨Ø¹Ø¯ ÙØ±Ù‚Ø§Ùƒ Ø£ÙŠØ§Ù…ÙŠ ÙƒÙ„Ù‡Ø§ Ø§Ø­Ø²Ø§Ù† Ø¹Ø·Ù†ÙŠ ÙŠÙ…ÙŠÙ†Ùƒ ÙˆÙÙƒÙ†ÙŠ Ø´Ø± Ø§Ù„ØºÙŠØ§Ø¨`;

    let index = 0;
    function typeEffect(){
        if(index < text.length){
            document.getElementById("loveText").innerHTML += text.charAt(index);
            index++;
            setTimeout(typeEffect,30);
        }
    }
    typeEffect();

    const chatBox = document.getElementById("chatBox");
    const input = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendBtn");

    let username = localStorage.getItem("username") || "";

    const loginOverlay = document.getElementById("loginOverlay");
    const usernameInput = document.getElementById("usernameInput");
    const loginBtn = document.getElementById("loginBtn");

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function login(){
        const name = usernameInput.value.trim();
        if(name==="") return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ!");
        username = name;
        localStorage.setItem("username", username);
        loginOverlay.style.display="none";
    }
    loginBtn.onclick = login;
    usernameInput.addEventListener("keydown", e=>{ if(e.key==="Enter") login(); });
    if(username) loginOverlay.style.display="none";

    function loadMessages(){
        const saved = localStorage.getItem("messages");
        if(saved){
            const messages = JSON.parse(saved);
            messages.forEach(msgObj=> addMessage(msgObj.text, msgObj.time, msgObj.user));
        }
    }

    function addMessage(text,time,user){
        const msgDiv = document.createElement("div");
        msgDiv.classList.add("message");

        const userSpan = document.createElement("span");
        userSpan.classList.add("msg-user");
        userSpan.textContent = user;

        const span = document.createElement("span");
        span.classList.add("msg-text");
        span.textContent = text;

        const timeSpan = document.createElement("span");
        timeSpan.classList.add("msg-time");
        timeSpan.textContent = time;

        const editBtn = document.createElement("button");
        editBtn.classList.add("editBtn");
        editBtn.textContent = "âœï¸";
        editBtn.onclick = ()=> editMessage(span, timeSpan, text, user);

        const delBtn = document.createElement("button");
        delBtn.classList.add("deleteBtn");
        delBtn.textContent = "ğŸ—‘ï¸";
        delBtn.onclick = ()=> deleteMessage(msgDiv, text, time, user);

        msgDiv.appendChild(userSpan);
        msgDiv.appendChild(span);
        msgDiv.appendChild(timeSpan);
        msgDiv.appendChild(editBtn);
        msgDiv.appendChild(delBtn);

        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function saveMessage(msg,time,user){
        let saved = localStorage.getItem("messages");
        let messages = saved ? JSON.parse(saved) : [];
        messages.push({text:msg,time:time,user:user});
        localStorage.setItem("messages",JSON.stringify(messages));
    }

    function deleteMessage(element,text,time,user){
        element.remove();
        let saved = localStorage.getItem("messages");
        if(saved){
            let messages = JSON.parse(saved);
            messages = messages.filter(m=>!(m.text===text && m.time===time && m.user===user));
            localStorage.setItem("messages",JSON.stringify(messages));
        }
    }

    function editMessage(span,timeSpan,oldText,user){
        const inputField = document.createElement("input");
        inputField.type="text"; inputField.value=oldText; inputField.style.flex="1";
        span.replaceWith(inputField);

        const saveBtn = document.createElement("button");
        saveBtn.classList.add("saveBtn"); saveBtn.textContent="ğŸ’¾";
        inputField.parentNode.insertBefore(saveBtn,inputField.nextSibling);

        function saveEdit(){
            const newText = inputField.value;
            inputField.replaceWith(span); saveBtn.remove(); span.textContent=newText;

            let saved = localStorage.getItem("messages");
            if(saved){
                let messages = JSON.parse(saved);
                const index = messages.findIndex(m=>m.text===oldText && m.time===timeSpan.textContent && m.user===user);
                if(index>-1){ messages[index].text=newText; localStorage.setItem("messages",JSON.stringify(messages)); }
            }
        }

        saveBtn.onclick = saveEdit;
        inputField.addEventListener("keydown", e=>{ if(e.key==="Enter") saveEdit(); });
    }

    function sendMessage(){
        if(input.value.trim()==="") return;
        if(!username) return alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹!");
        const msg = input.value;
        const now = new Date();
        const time = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
        addMessage(msg,time,username);
        saveMessage(msg,time,username);
        input.value="";
    }

    sendBtn.onclick = sendMessage;
    input.addEventListener("keydown", e=>{ if(e.key==="Enter") sendMessage(); });

    loadMessages();

    function createHeart(){
        const heart = document.createElement("div");
        heart.classList.add("heart");
        heart.textContent="ğŸ’—";
        heart.style.left=Math.random()*window.innerWidth+"px";
        heart.style.fontSize=(20+Math.random()*30)+"px";
        heart.style.animationDuration=(3+Math.random()*3)+"s";
        document.body.appendChild(heart);
        setTimeout(()=>heart.remove(),6000);
    }
    setInterval(createHeart,250);
</script>

</body>
</html>

